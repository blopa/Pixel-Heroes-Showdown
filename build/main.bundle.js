!function(e){function t(t){for(var s,r,o=t[0],l=t[1],h=t[2],u=0,d=[];u<o.length;u++)r=o[u],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&d.push(a[r][0]),a[r]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);for(c&&c(t);d.length;)d.shift()();return n.push.apply(n,h||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],s=!0,o=1;o<i.length;o++){var l=i[o];0!==a[l]&&(s=!1)}s&&(n.splice(t--,1),e=r(r.s=i[0]))}return e}var s={},a={0:0},n=[];function r(t){if(s[t])return s[t].exports;var i=s[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.e=function(e){var t=[],i=a[e];if(0!==i)if(i)t.push(i[2]);else{var s=new Promise((function(t,s){i=a[e]=[t,s]}));t.push(i[2]=s);var n,o=document.createElement("script");o.charset="utf-8",o.timeout=120,r.nc&&o.setAttribute("nonce",r.nc),o.src=function(e){return r.p+""+({}[e]||e)+".bundle.js"}(e);var l=new Error;n=function(t){o.onerror=o.onload=null,clearTimeout(h);var i=a[e];if(0!==i){if(i){var s=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+s+": "+n+")",l.name="ChunkLoadError",l.type=s,l.request=n,i[1](l)}a[e]=void 0}};var h=setTimeout((function(){n({type:"timeout",target:o})}),12e4);o.onerror=o.onload=n,document.head.appendChild(o)}return Promise.all(t)},r.m=e,r.c=s,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(i,s,function(t){return e[t]}.bind(null,s));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="./build/",r.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp=window.webpackJsonp||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var h=0;h<o.length;h++)t(o[h]);var c=l;n.push([13,1]),i()}([,
/*!***************************!*\
  !*** ./src/utils/urls.js ***!
  \***************************/
/*! exports provided: getRequestUrl, postData */
/*! exports used: getRequestUrl, postData */
/*! ModuleConcatenation bailout: Module uses injected variables (process) */,function(e,t,i){"use strict";(function(e){i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return a}));var s=t=>{var i,s=(null===(i=e)||void 0===i?void 0:void i.env)||"";return"".concat(s,"/").concat(t)},a=(e,t)=>{var i={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};return fetch(e,i).then(e=>{if(!e.ok)throw Error("Network request failed");return e.json().then(t=>({status:e.status,body:t}))})}}).call(this,i(/*! ./../../node_modules/process/browser.js */12))},,,,,,
/*!*****************************!*\
  !*** ./src/locales/en.json ***!
  \*****************************/
/*! exports provided: debug_menu, game_start, start, quick_play, select_your_hero, waiting_for_players, loading_game_data, players_text, settings_menu, settings, portuguese, english, no_action, cancel, confirm, default */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */,function(e){e.exports=JSON.parse('{"debug_menu":"Debug Menu","game_start":"Game Start","start":"Start","quick_play":"Quick Play","select_your_hero":"Select Your Hero","waiting_for_players":"Waiting for other players","loading_game_data":"Loading game data","players_text":"Players:","settings_menu":"Settings","settings":"Settings","portuguese":"Portuguese","english":"English","no_action":"No Action","cancel":"Cancel","confirm":"Confirm"}')},
/*!********************************!*\
  !*** ./src/locales/pt-br.json ***!
  \********************************/
/*! exports provided: debug_menu, game_start, start, quick_play, select_your_hero, waiting_for_players, loading_game_data, players_text, settings_menu, settings, portuguese, english, no_action, cancel, confirm, default */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e){e.exports=JSON.parse('{"debug_menu":"Menu Debug","game_start":"Começar Jogo","start":"Começar","quick_play":"Partida Rápida","select_your_hero":"Selecione o Seu Herói","waiting_for_players":"Esperando por outros jogadores","loading_game_data":"Carregando dados do jogo","players_text":"Jogadores:","settings_menu":"Configurações","settings":"Configurações","portuguese":"Português","english":"Inglês","no_action":"Nenhuma Ação","cancel":"Cancelar","confirm":"Confirmar"}')},
/*!*************************************************!*\
  !*** ./src/plugins/rexawaitloaderplugin.min.js ***!
  \*************************************************/
/*! no static exports found */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,i){!function(t,i){e.exports=i()}(0,()=>{function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function i(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&function(e,t){(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function n(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],()=>{})),!0}catch(e){return!1}}();return function(){var i,s=a(e);if(t){var r=a(this).constructor;i=Reflect.construct(s,arguments,r)}else i=s.apply(this,arguments);return n(this,i)}}function o(e,t){var i;return(i=e)&&"function"==typeof i?t={config:{callback:e,scope:t}}:c(e)?(t=e).hasOwnProperty("config")||(t={config:t}):t={key:e,config:t},this.addFile(new h(this,t)),this}var l=Phaser.Loader.FILE_POPULATED,h=function(){s(a,Phaser.Loader.File);var t=r(a);function a(i,s){return e(this,a),s.hasOwnProperty("type")||(s.type="await"),s.hasOwnProperty("url")||(s.url=""),s.hasOwnProperty("key")||(s.key=(new Date).getTime().toString()),t.call(this,i,s)}return i(a,[{key:"load",value(){if(this.state===l)this.loader.nextFile(this,!0);else{var e=this.config,t=e.callback,i=e.scope,s=this.onLoad.bind(this),a=this.onError.bind(this);t?i?t.call(i,s,a):t(s,a):this.onLoad()}}},{key:"onLoad",value(){this.loader.nextFile(this,!0)}},{key:"onError",value(){this.loader.nextFile(this,!1)}}]),a}(),c=Phaser.Utils.Objects.IsPlainObject;return function(){s(a,Phaser.Plugins.BasePlugin);var t=r(a);function a(i){var s;return e(this,a),s=t.call(this,i),i.registerFileType("rexAwait",o),s}return i(a,[{key:"addToScene",value(e){e.sys.load.rexAwait=o}}]),a}()})},
/*!**********************************!*\
  !*** ./src/main.js + 55 modules ***!
  \**********************************/
/*! no exports provided */
/*! all exports used */
/*! ModuleConcatenation bailout: Cannot concat with ./src/plugins/rexawaitloaderplugin.min.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/urls.js (<- Module uses injected variables (process)) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/fast-deep-equal/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/i18next-browser-languagedetector/dist/esm/i18nextBrowserLanguageDetector.js (<- Module is referenced from these modules with unsupported syntax: multi fast-deep-equal i18next i18next-browser-languagedetector javascript-astar mobile-device-detect phaser (referenced with single entry)) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/i18next/dist/esm/i18next.js (<- Module is referenced from these modules with unsupported syntax: multi fast-deep-equal i18next i18next-browser-languagedetector javascript-astar mobile-device-detect phaser (referenced with single entry)) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/javascript-astar/astar.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/mobile-device-detect/dist/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/phaser/dist/phaser.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/locales/en.json (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/locales/pt-br.json (<- Module is not an ECMAScript module) */,function(e,t,i){"use strict";i.r(t);var s=i(0),a=i.n(s),n=i(1),r=i(8),o=i(9),l=i(10);function h(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function c(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?h(Object(i),!0).forEach((function(t){u(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var d={en:{translation:c({},o)},"pt-BR":{translation:c({},l)}},p=i(3),g=32,y="20px",m=160,f=6777462,b=5922408,v=e=>null!==e&&"object"==typeof e&&0===Object.keys(e).length&&e.constructor===Object,x=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Array(e).fill().map(()=>Array(t).fill(i))},S=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];for(var s of t)if(v(s)||null==s||Array.isArray(s)&&!s.length)return!1;return!0},w=()=>Math.random().toString(36).slice(-10),O=e=>["ArrowUp","W","w"].includes(e),C=e=>["ArrowRight","D","d"].includes(e),P=e=>["ArrowDown","S","s"].includes(e),k=e=>["ArrowLeft","A","a"].includes(e),_=e=>["Enter"].includes(e),T=e=>["q","Shift"].includes(e),j=e=>["Escape"].includes(e),B=(e,t,i)=>{var s=x(e,t);return i.forEach(e=>{var{position:t}=e,{x:i,y:a}=t;s[a-1][i-1]=1}),s};function M(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class A extends s.GameObjects.Group{constructor(e){var t,{scene:i,children:s,name:a}=e;super(i,s,{name:a}),t=this,M(this,"setGroupVisible",(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.groupVisible=e,t.setVisible(e)})),M(this,"setEquivalentY",e=>{var t=0,i=e;this.getChildren().forEach(e=>{t?i+=Math.abs(t-e.y):t=e.y,e.setY(i)})}),M(this,"setEquivalentX",e=>{var t=0,i=e;this.getChildren().forEach(e=>{t?i+=Math.abs(t-e.x):t=e.x,e.setX(i)})}),M(this,"forEach",e=>this.getChildren().forEach(e)),this.groupVisible=!0}}var I=A;var G=class extends I{constructor(e){var t,i,a,{scene:n,x:r=0,y:o=0,name:l="background",assets:h=["parallax_background_1","parallax_background_2","parallax_background_3"]}=e;for(var c of(super({scene:n,children:[],name:l}),a=(e,t)=>{var i=[.2,.5,1],s=0;if(this.getChildren())for(var a of this.getChildren()){var{width:n}=a.getBounds();a.x>=n&&a.setX(0-n),a.setX(a.x+i[Math.floor(s/2)]),s++}},(i="update")in(t=this)?Object.defineProperty(t,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[i]=a,h)){var u=new s.GameObjects.Image(n,r,o,c).setOrigin(0,0),{width:d}=u.getBounds(),p=new s.GameObjects.Image(n,r-d,o,c).setOrigin(0,0);this.add(u),this.add(p)}this.setDepth(0),this.setOrigin(0,0)}};function D(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var E=new WeakMap;class K extends s.Scene{constructor(){super(...arguments),E.set(this,{writable:!0,value:{}}),D(this,"handleSceneEnd",(e,t)=>{this.cameras.main.fadeOut(200),this.time.delayedCall(200,()=>{this.scene.start(e,t)})}),D(this,"handleSceneStart",()=>{this.cameras.main.fadeIn(200)}),D(this,"setState",(e,t)=>{var i,s;i=(s=e)&&"[object Function]"==={}.toString.call(s)?e(this.state):e,Object.keys(i).forEach((e,t,s)=>{Object.prototype.hasOwnProperty.call(this.state,e)&&(this.state[e]=i[e])}),t&&t()})}create(){p.isMobile||this.input.on("pointermove",e=>{var{x:t,y:i}=e;window.gameSettings.mousePosition={x:t,y:i}});var e=new G({scene:this});e.forEach(e=>{this.add.existing(e)}),function(e,t,i){var s=t.get(e);if(!s)throw new TypeError("attempted to set private field on non-instance");if(s.set)s.set.call(e,i);else{if(!s.writable)throw new TypeError("attempted to set read only private field");s.value=i}}(this,E,e)}update(e,t){(function(e,t){var i=t.get(e);if(!i)throw new TypeError("attempted to get private field on non-instance");return i.get?i.get.call(e):i.value})(this,E).update(e,t)}}var z=K;var H=class extends z{constructor(){super("BootScene")}preload(){}create(){this.sys.game.canvas.focus(),this.scene.start("AssetsLoaderScene")}};var N=class extends z{constructor(){super("AssetsLoaderScene"),function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"loadAtlas",(e,t,i)=>this.load.atlas(e,"assets/images/".concat(t),"assets/atlas/".concat(i)))}preload(){this.load.image("background","assets/images/background.png"),this.load.image("parallax_background_1","assets/images/parallax_background_1.png"),this.load.image("parallax_background_2","assets/images/parallax_background_2.png"),this.load.image("parallax_background_3","assets/images/parallax_background_3.png"),this.load.image("pixel_heroes_logo","assets/images/pixel_heroes_logo.png"),this.load.image("tileset_old","assets/images/tileset_old.png"),this.load.image("board_cursor","assets/images/board_cursor.png"),this.load.image("mouse_cursor","assets/images/mouse_cursor.png"),this.load.image("bomb_target_position","assets/images/bomb_target_position.png"),this.load.image("bomb_target_position_doubled","assets/images/bomb_target_position_doubled.png"),this.load.image("bomb","assets/images/bomb.png"),this.load.image("base_01","assets/images/base_01.png"),this.load.image("hero_base","assets/images/hero_base.png"),this.loadAtlas("trampoline","trampoline.png","trampoline.json"),this.loadAtlas("portal_gun","portal_gun.png","portal_gun.json"),this.loadAtlas("invisibility_cape","invisibility_cape.png","invisibility_cape.json"),this.loadAtlas("hero_01","hero_01.png","heroes/hero_01_atlas.json"),this.loadAtlas("hero_02","hero_02.png","heroes/hero_02_atlas.json"),this.loadAtlas("hero_03","hero_03.png","heroes/hero_03_atlas.json"),this.loadAtlas("hero_04","hero_04.png","heroes/hero_04_atlas.json"),this.loadAtlas("hero_05","hero_05.png","heroes/hero_05_atlas.json"),this.loadAtlas("hero_06","hero_06.png","heroes/hero_06_atlas.json"),this.loadAtlas("hero_07","hero_07.png","heroes/hero_07_atlas.json"),this.loadAtlas("hero_08","hero_08.png","heroes/hero_08_atlas.json"),this.loadAtlas("hero_09","hero_09.png","heroes/hero_09_atlas.json"),this.loadAtlas("blocks","blocks.png","blocks.json"),this.loadAtlas("loading","loading.png","loading.json"),this.load.image("tileset","assets/images/tileset.png"),this.loadAtlas("flag","flag.png","flag.json")}create(){this.scene.start("MainMenuScene")}update(){}},X=i(7),F=[{y:g,x:0},{y:2*g,x:0},{y:2*g,x:3*g},{y:0,x:3*g},{y:0,x:2*g},{y:g,x:2*g}],Y=[[0,0,1],[1,1,1]],R=[{y:0,x:0},{y:2*g,x:0},{y:2*g,x:3*g},{y:g,x:3*g},{y:g,x:g},{y:0,x:g}],V=[[1,0,0],[1,1,1]],L=[{y:0,x:0},{y:g,x:0},{y:g,x:g},{y:2*g,x:g},{y:2*g,x:3*g},{y:g,x:3*g},{y:g,x:2*g},{y:0,x:2*g}],W=[[1,1,0],[0,1,1]],q=[{y:g,x:0},{y:2*g,x:0},{y:2*g,x:2*g},{y:g,x:2*g},{y:g,x:3*g},{y:0,x:3*g},{y:0,x:g},{y:g,x:g}],U=[[0,1,1],[1,1,0]],J=[{y:0,x:0},{y:0,x:4*g},{y:g,x:4*g},{y:g,x:0}],Q=[[1,1,1,1]],Z=[{y:g,x:0},{y:2*g,x:0},{y:2*g,x:3*g},{y:g,x:3*g},{y:g,x:2*g},{y:0,x:2*g},{y:0,x:g},{y:g,x:g}],$=[[0,1,0],[1,1,1]],ee=[{y:0,x:0},{y:2*g,x:0},{y:2*g,x:2*g},{y:0,x:2*g}],te=[[1,1],[1,1]],ie=2*g,se=.5,ae=e=>{switch(e){case 1:return 16777045;case 2:return 12255232;case 3:return 65280;case 4:return 52991;default:return null}},ne=e=>{switch(e){case 2:case 20:return 2;case 3:case 30:return 3;case 4:case 40:return 4;case 1:case 10:return 1;default:return null}},re=e=>10===e||20===e||30===e||40===e,oe=e=>{switch(e){case 3:return F;case 2:return R;case 7:return L;case 5:return q;case 1:return J;case 6:return Z;case 4:return ee;default:return[]}},le=e=>{switch(e){case 3:return Y;case 2:return V;case 7:return W;case 5:return U;case 1:return Q;case 6:return $;case 4:return te;default:return[]}},he=i(2);function ce(){var e=this.data.get("playerData");if(S(e))return e;var t=this.data.get("playerNickname");return e=(e=this.data.get("playersList").filter(e=>e.nickname===t)).length&&e[0],this.data.set("playerData",e),e}function ue(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{x:i,y:s}=this.state.mainGameMapSprite.getCustomBounds();return{x:e*g+i-g,y:t*g+s-g}}function de(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{x:i,y:s}=this.state.mainGameMapSprite.getCustomBounds();return{x:Math.floor((e-i)/g)+1,y:Math.floor((t-s)/g)+1}}function pe(e){if(window.gameSettings.enableGameDebug)return console.log("fetchStatusGame"),void i.e(/*! import() */8).then(i.t.bind(null,/*! ../../requests/status-game */17,3)).then(t=>{e.call(this,{body:t})});var t=Object(he.a)("status-game"),s={heroType:this.data.get("heroType"),nickname:this.data.get("playerNickname"),gameId:this.data.get("gameId")};Object(he.b)(t,s).then(e.bind(this))}function ge(e,t){var{key:i}=e,s=_(i),a=P(i),n=O(i);if(s||a||n){var r,o=t.findIndex(e=>e.selected);if(s&&o>=0&&o<=t.length)t[o].onClickCallback();else n?(o=o>=0?o:t.length,r=o-1):a&&(r=o+1),t.forEach((e,t)=>{t===r?e.setSelected(!0):e.setSelected(!1)})}}function ye(){var e=this.data.get("heroColor");return this.state.sceneHeroesSprite.find(t=>t.heroColor===e)}function me(e){var{body:t={}}=e,{game:i={}}=t,{board:s={},pendingPlayers:a}=i,{blockMap:n,bases:r,flags:o,heroes:l,items:h}=s;S(l)&&this.data.set("heroes",l),S(n)&&this.data.set("blockMap",n),S(r)&&this.data.set("bases",r),S(o)&&this.data.set("flags",o),S(h)&&this.data.set("items",h),S(a)&&this.data.set("pendingPlayers",a)}function fe(e){this.add.existing(e),e.verticallyCenterObject(),e.setOnPointerOver(()=>{e.setSelected(!0)}),e.setOnPointerOut(()=>{e.setSelected(!1)}),e.setOnSelectedOn(()=>{e.setScale(1.02)}),e.setOnSelectedOff(()=>{e.setScale(1)})}function be(e){var t=this.data.get("pendingPlayers");return Boolean(t.find(t=>t.nickname===e))}function ve(){xe.call(this)}function xe(){if(window.gameSettings.enableGameDebug)return console.log("fetchGenerateTetromino"),void i.e(/*! import() */4).then(i.t.bind(null,/*! ../../requests/generate-tetromino */15,3)).then(e=>{Se.call(this,{body:e})});var e=Object(he.a)("block-phase/generate-tetromino"),t={heroType:this.data.get("heroType"),nickname:this.data.get("playerNickname"),gameId:this.data.get("gameId")};Object(he.b)(e,t).then(Se.bind(this))}function Se(e){var{body:t}=e,{tetromino:i}=t,{type:s}=i;return this.data.set("tetrominoType",s)}function we(e,t){if(window.gameSettings.enableGameDebug)return console.log("fetchDropTetromino"),void i.e(/*! import() */3).then(i.t.bind(null,/*! ../../requests/drop-tetromino */16,3)).then(e=>{Oe.call(this,{body:e})});var s=Object(he.a)("block-phase/drop-tetromino"),a={nickname:this.data.get("playerNickname"),heroType:this.data.get("heroType"),gameId:this.data.get("gameId"),tetromino:t,board:{blockMap:e}};Object(he.b)(s,a).then(Oe.bind(this))}function Oe(e){var{body:t}=e,{game:i}=t,{turnPhase:s,pendingPlayers:a}=i;this.data.set("tetrominoType",null),this.data.get("pendingPlayers")!==a&&this.data.set("pendingPlayers",a),this.data.get("nextTurnPhase")!==s?(me.call(this,e),this.data.set("nextTurnPhase",s),this.data.set("turnPhase",s)):this.time.delayedCall(2e3,()=>pe.call(this,Oe.bind(this)))}function Ce(){this.rotateTetromino()}function Pe(){this.off("pointerdown"),this.on("pointerup",Ce.bind(this))}function ke(){this.setIndividualChildScale(.9),this.setScale(1/.9),this.resetIsMoving(),this.setIsMovingWithMouse(!0),S(this.scene.state.boardCursorSprite)&&this.scene.state.boardCursorSprite.deactivateCursor(),this.off("pointerup")}function _e(e,t,i){var{tetrominoShadow:s}=this,{x:a,y:n}=s.calculateTetrominoShadowBoardPositionFromPosition(t,i),r=i,o=n;if(p.isMobile&&(r=i-ie,o=n-ie),this.setY(r),this.setX(t),s.x!==a||s.y!==o)if(s.setY(o),s.setX(a),Ee.call(s)){s.setVisible(!0);var l=Be.call(s);s.setPositionState(l)}else s.setVisible(!1)}function Te(e){var{tetrominoShadow:t,scene:i}=this;this.setIndividualChildScale(1),this.setScale(1),this.resetIsMoving(),p.isMobile&&this.setY(this.y+ie),S(this.scene.state.boardCursorSprite)&&(i.state.boardCursorSprite.activateCursor(),i.state.boardCursorSprite.setBoardPositionFromPosition(e.x,e.y)),Ee.call(t)&&1!==t.positionState?this.onDrop():(this.resetTetrominoToInitialPosition(),this.on("pointerdown",Pe.bind(this)))}function je(){var{x:e,y:t}=this.scene.state.mainGameMapSprite.getCustomBounds(),{x:i,y:s}=this.getCustomBounds();return{x:Math.floor((Math.round(i)-e)/g)+1,y:Math.floor((Math.round(s)-t)/g)+1}}function Be(){var{x:e,y:t}=je.call(this),i=this.scene.data.get("blockMap"),s=(e=>{switch(e){case 2:return 200;case 3:return 300;case 4:return 400;case 1:return 100;default:return null}})(this.heroColor),[a,n]=[t-1,e-1],{tetrominoArray:r}=this,o=null;return r.every((e,t)=>e.every((e,r)=>{if(1===e&&i[a+t][n+r]===s)return o=2,!1;return!0})),o||r.every((e,t)=>e.every((e,s)=>{if(1===e&&0!==i[a+t][n+s])return o=1,!1;return!0})),o||0}function Me(e){var t;if(S(null===(t=this.scene.state)||void 0===t?void 0:t.mainGameMapSprite)){var{width:i,height:s,x:a,y:n}=this.scene.state.mainGameMapSprite.getCustomBounds();if(e.x>a&&e.x<a+i&&e.y>n&&e.y<n+s)return!0}return!1}function Ae(){var{height:e,y:t}=this.getCustomBounds(),{height:i,y:s}=this.scene.state.mainGameMapSprite.getCustomBounds();return Math.ceil(Math.round(t)+Math.round(e))>s+i}function Ie(){var{width:e,x:t}=this.getCustomBounds(),{width:i,x:s}=this.scene.state.mainGameMapSprite.getCustomBounds();return Math.ceil(Math.round(t)+Math.round(e))>s+i}function Ge(){var{y:e}=this.getCustomBounds(),{y:t}=this.scene.state.mainGameMapSprite.getCustomBounds();return Math.round(e)<t}function De(){var{x:e}=this.getCustomBounds(),{x:t}=this.scene.state.mainGameMapSprite.getCustomBounds();return Math.round(e)<t}function Ee(){var e;if(S(null===(e=this.scene.state)||void 0===e?void 0:e.mainGameMapSprite)){if(Ae.call(this))return!1;if(Ie.call(this))return!1;if(Ge.call(this))return!1;if(De.call(this))return!1}return!0}function Ke(){var e,{tetrominoShadow:t,scene:i}=this,{tetrominoArray:s,positionState:a}=t,{x:n,y:r}=je.call(t),{height:o,width:l}=this.scene.data.get("boardSize"),h=x(o,l),[c,u]=[r-1,n-1],d=i.data.get("heroColor"),p=s.map(e=>e.map(e=>e&&d)),g=this.scene.data.get("tetrominoType");2===a?g=-1:e=((e,t,i)=>{var{x:s,y:a}=i,n=e[0].length,r=e.length,o=t.map(e=>{var t=Array(s).fill(0),i=Array(n-(s+e.length)).fill(0);return t.concat(e,i)}),l=e.slice(r-a);return o.forEach(e=>{l.push(e)}),l.concat(e).slice(0,r)})(h,p,{x:u,y:c}),t.destroy(),this.removeInputListener(),this.destroy(),i.state.tetrominoGameBoxSprite.destroy(),i.setState({tetrominoGameBoxSprite:{}}),console.log({tetrominoArray:s,newMapArray:e}),we.call(i,e,g)}function ze(e,t,i,s){var{x:a,y:n}=this.getBoardTilePosition();this.setBoardTilePosition(e,t);var r=new X.Graph(i),o=X.astar.search(r,r.grid[n-1][a-1],r.grid[t-1][e-1]),l=this;(null==o?void 0:o.length)&&requestAnimationFrame(()=>{!function e(t,i){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(a>=t.length)return void(null==s||s());var n="walk";a+1===t.length&&(n="idle");var{x:r,y:o}=t[a];i.moveToBoardTilePosition(o+1,r+1,"walk",n,()=>{requestAnimationFrame(()=>{e(t,i,s,a+1)})})}(o,l,s)})}function He(e){this.spriteKey=e}function Ne(e){this.customBounds=e}function Xe(){return this.customBounds?this.customBounds:this.getBounds()}function Fe(){var{width:e}=this.scene.sys.game.canvas,{width:t,height:i,y:s}=this.getCustomBounds(),a=(e-t)/2;this.setX(a),S(this.getBounds)||this.setCustomBounds({width:t,height:i,x:a,y:s})}function Ye(){var{width:e}=this.scene.sys.game.canvas,{width:t,height:i,y:s}=this.getCustomBounds(),{originX:a}=this,n=(e-t)/2;0!==a&&void 0!==a&&(n+=t*a),this.setX(n),S(this.getBounds)||this.setCustomBounds({width:t,height:i,x:n,y:s})}function Re(){return this.initialPosition}function Ve(e){var{x:t,y:i}=e;this.initialPosition={x:t,y:i},this.setX(t),this.setY(i)}function Le(){var{width:e}=this.scene.sys.game.canvas,{width:t}=this.getCustomBounds();this.setX(e-t)}function We(){var{height:e}=this.scene.sys.game.canvas,{height:t}=this.getCustomBounds();this.setY(e-t)}function qe(e){this.tetrominoArray=e}function Ue(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.enabled=e}function Je(e){this.heroColor=e}function Qe(e){this.tetrominoType=e}function Ze(e,t){this.boardTilePosition={x:e,y:t}}function $e(){if(this.boardTilePosition)return this.boardTilePosition;var{x:e,y:t}=je.call(this);return this.setBoardTilePosition(e,t),this.boardTilePosition}function et(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class tt extends s.Tilemaps.Tilemap{constructor(e){var{scene:t,x:i=0,y:a=0,data:n,tileWidth:r,tileHeight:o,width:l,height:h,layerName:c,tilesetName:u,asset:d}=e,p=new s.Tilemaps.LayerData({height:h,width:l,baseTileHeight:o,baseTileWidth:r,tileHeight:o,tileWidth:r,heightInPixels:h*o,widthInPixels:l*r,name:c});p.data=((e,t,i,a)=>t.map((t,n)=>t.map((t,r)=>new s.Tilemaps.Tile(e,t,r,n,i,a,i,a))))(p,n,r,o),super(t,new s.Tilemaps.MapData({data:n,tileWidth:r,tileHeight:o,width:l,height:h,layers:[p]})),et(this,"verticallyCenterObject",()=>{var{width:e}=this.scene.sys.game.canvas,{width:t,height:i,y:s}=this.getCustomBounds(),a=(e-t)/2;this.staticTilemapLayer.setX(a),this.setCustomBounds({width:t,height:i,x:a,y:s})}),et(this,"setTileset",e=>{this.tileset=e}),et(this,"setStaticTilemapLayer",e=>{this.staticTilemapLayer=e}),Object.assign(this,{setSpriteKey:He,setCustomBounds:Ne,getCustomBounds:Xe});var y=this.addTilesetImage(u,d),m=this.createStaticLayer(c,y,i,a).setDepth(10);this.setTileset(y),this.setStaticTilemapLayer(m),this.setCustomBounds({width:l*g,height:h*g,x:i,y:a})}}var it=tt;class st extends s.GameObjects.Graphics{constructor(e){var{scene:t,visible:i=!0,active:s=!0,spriteKey:a=w(),width:n,height:r,x:o=0,y:l=0,alpha:h=1}=e;super(t),Object.assign(this,{setSpriteKey:He,verticallyCenterObject:Fe,setCustomBounds:Ne,getCustomBounds:Xe}),this.setX(o),this.setY(l),this.setVisible(Boolean(i)),this.setActive(Boolean(s)),this.setAlpha(h),this.setSpriteKey(a),this.setCustomBounds({width:n,height:r,x:o,y:l})}}var at=st;function nt(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var rt=class extends at{constructor(e){var t,{scene:i,x:a=0,y:n=0,gridSize:r=g,alpha:o=1,boardTilePosition:l,backgroundColor:h,height:c,width:u,visible:d,spriteKey:p,depth:y,onClickCallback:m}=e;super({scene:i,visible:d,spriteKey:p,width:u,height:c,alpha:o,x:a,y:n}),nt(this,"setBackgroundColor",e=>{this.backgroundColor=e,this.fillStyle(e,1),this.fillRectShape(this.backgroundShape)}),nt(this,"setBackgroundShape",e=>{this.backgroundShape=e}),Object.assign(this,{verticallyCenterObject:Fe,setSpriteKey:He,setCustomBounds:Ne,getCustomBounds:Xe,getBoardTilePosition:$e,setBoardTilePosition:Ze}),this.setDepth(y),this.lineStyle(1,0,.7);for(var f=0;f<=u;f++)this.moveTo(0,f*r),this.lineTo(u*r,f*r);for(var b=0;b<=c;b++)this.moveTo(b*r,0),this.lineTo(b*r,c*r);(h||m)&&(t=new s.Geom.Rectangle(0,0,u*r,c*r)),h&&(this.setBackgroundShape(t),this.setBackgroundColor(h)),m&&(this.setInteractive(t,s.Geom.Rectangle.Contains),this.on("pointerup",m.bind(this))),this.strokePath(),l&&this.setBoardTilePosition(l.x,l.y),this.setCustomBounds({height:c*r,width:u*r,x:a,y:n})}};class ot extends s.GameObjects.Sprite{constructor(e){var{scene:t,asset:i,x:s=0,y:a=0,frame:n=null}=e;super(t,s,a,i,n),Object.assign(this,{setSpriteKey:He,verticallyCenterObject:Fe,setCustomBounds:Ne,getCustomBounds:Xe,setEnlabled:Ue}),this.setOrigin(0,0)}}var lt=ot;var ht=class extends lt{constructor(e){var{scene:t,x:i=0,y:s=0,asset:a="loading",frames:n=["loading_1","loading_2","loading_3","loading_4","loading_5","loading_6","loading_7","loading_8"]}=e;super({scene:t,x:i,y:s,asset:a}),t.anims.create({key:"loading_key",frames:t.anims.generateFrameNames(a,{frames:n}),frameRate:8,repeat:-1}),this.anims.play("loading_key"),this.setDepth(m),this.setScale(4),this.setOrigin(0,0)}};function ct(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function ut(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(i),!0).forEach((function(t){dt(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ct(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function dt(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class pt extends s.GameObjects.Text{constructor(e){var{scene:t,x:i=0,y:s=0,color:a="#FFFFFF",fontSize:n=y,style:r={},visible:o=!0,active:l=!0,text:h="",uppercase:c,originX:u,originY:d,origin:p={x:S(u)?u:.5,y:S(d)?u:.5},spriteKey:g=w()}=e,m={fontFamily:"Arial",color:a,align:"center",fontSize:n};c&&(h=h.toUpperCase()),super(t,i,s,h,ut(ut({},m),r)),Object.assign(this,{setSpriteKey:He,verticallyCenterObject:Fe,setCustomBounds:Ne,getCustomBounds:Xe,verticallyRightObject:Le,horizontallyBottomObject:We}),this.setDepth(170),this.setOrigin(p.x,p.y),this.setVisible(Boolean(o)),this.setActive(Boolean(l)),this.setSpriteKey(g)}}var gt=pt;class yt extends s.GameObjects.Image{constructor(e){var{scene:t,x:i=0,y:s=0,asset:a}=e;super(t,i,s,a),Object.assign(this,{setSpriteKey:He,verticallyCenterObject:Fe,setCustomBounds:Ne,getCustomBounds:Xe}),this.setOrigin(0,0)}}var mt=yt;function ft(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var bt=class extends mt{constructor(e){var t,{scene:i,x:s=0,y:a=0,asset:n="board_cursor"}=e;super({scene:i,x:Math.round(s/g)*g-g/2,y:Math.floor(a/g)*g+g/2,asset:n}),t=this,ft(this,"onKeyDown",e=>{if(this.active){var{key:t}=e,{x:i,y:s}=this,a=O(t),n=C(t),r=P(t),o=k(t);if(a)s=this.y-g;else if(n)i=this.x+g;else if(r)s=this.y+g;else{if(!o)return;i=this.x-g}if(Me.call(this,{x:i+g/2,y:s+g/2})){this.setX(i),this.setY(s);var{x:l,y:h}=this.scene.state.mainGameMapSprite.getCustomBounds();this.setBoardTilePosition((i-l)/g+1,(s-h)/g+1)}}}),ft(this,"onPointerMove",e=>{if(this.active)if(Me.call(this,window.gameSettings.mousePosition)){var{x:t,y:i}=this.calculateCursorBoardBoardPositionFromPosition(e.x,e.y),{width:s,height:a,x:n,y:r}=this.scene.state.mainGameMapSprite.getCustomBounds();t<n||i<r||t>n+s||i>r+a?this.setCursorVisible(!1):(this.setX(t),this.setY(i),this.setBoardTilePosition((t-n)/g+1,(i-r)/g+1),this.activateCursor())}else this.setCursorVisible(!1)}),ft(this,"calculateCursorBoardBoardPositionFromPosition",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,{width:s,height:a,x:n,y:r}=t.scene.state.mainGameMapSprite.getCustomBounds(),o=(s+g)/s*g,l=(a+g)/a*g,h=Math.floor(e/g)*g+g/2-g;(e%g>=Math.floor(o/2)||h<n)&&(h+=g);var c=Math.floor(i/g)*g+g/2-g;return(i%g>=Math.floor(l/2)||c<r)&&(c+=g),{x:h,y:c}})),ft(this,"deactivateCursor",()=>{this.setActive(!1),this.setCursorVisible(!1)}),ft(this,"activateCursor",()=>{this.setActive(!0),Ee.call(this)&&this.setCursorVisible(!0)}),ft(this,"setCursorVisible",e=>{this.setVisible(e),e?"none"!==this.scene.sys.canvas.style.cursor&&(this.scene.sys.canvas.style.cursor="none"):"none"===this.scene.sys.canvas.style.cursor&&(this.scene.sys.canvas.style.cursor="default")}),ft(this,"setBoardPositionFromPosition",(e,t)=>{var{x:i,y:s}=this.calculateCursorBoardBoardPositionFromPosition(e,t);Me.call(this,{x:e,y:t})?this.setCursorVisible(!0):this.setCursorVisible(!1),this.setX(i),this.setY(s)}),Object.assign(this,{setBoardTilePosition:Ze,getBoardTilePosition:$e}),this.setDepth(900),this.setOrigin(0,0),this.setVisible(!1),Me.call(this,this)&&this.setCursorVisible(!0),i.input.on("pointermove",this.onPointerMove),i.input.keyboard.on("keydown",this.onKeyDown)}},vt=i(6),xt=i.n(vt);function St(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class wt extends s.GameObjects.Container{constructor(e){var{scene:t,x:i=0,y:a=0,visible:n=!0,active:r=!0,spriteKey:o=w()}=e;super(t,i,a),St(this,"getBounds",e=>{if(void 0===e&&(e=new s.Geom.Rectangle),e.setTo(this.x,this.y,0,0),this.parentContainer){var t=this.parentContainer.getBoundsTransformMatrix().transformPoint(this.x,this.y);e.setTo(t.x,t.y,0,0)}if(this.list.length>0){var i=this.list,a=new s.Geom.Rectangle,n=i.find(e=>"function"==typeof e.getBounds).getBounds();e.setTo(n.x,n.y,n.width,n.height);for(var r=1;r<i.length;r++){var o=i[r];o.getBounds&&(o.getBounds(a),s.Geom.Rectangle.Union(a,e,e))}}return e}),St(this,"centralizeChildren",()=>{var{width:e,height:t}=this.getBounds();this.list.forEach(i=>{var{x:s,y:a}=i;i.setX(s-e/2),i.setY(a-t/2)})}),St(this,"setIndividualChildScale",e=>{this.list.forEach(t=>{t.setScale(e)})}),Object.assign(this,{setSpriteKey:He,verticallyCenterObject:Fe,setCustomBounds:Ne,getCustomBounds:Xe}),this.setVisible(Boolean(n)),this.setActive(Boolean(r)),this.setSpriteKey(o)}}var Ot=wt;function Ct(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var Pt=class extends at{constructor(e){var{scene:t,x:i=0,y:a=0,backgroundColor:n=f,marginColor:r=b,marginSize:o=0,visible:l=!0,active:h=!0,depth:c=m,width:u,height:d,onClickCallback:p,spriteKey:g="",onPointerOver:y,onPointerOut:v,alpha:x=1}=e;super({scene:t,visible:l,active:h,spriteKey:g,width:u,height:d,x:i+o/2,y:a+o/2}),Ct(this,"setBackgroundColor",e=>{this.backgroundColor=e,this.fillStyle(e,1),this.fillRectShape(this.backgroundShape)}),Ct(this,"setBackgroundShape",e=>{this.backgroundShape=e});var S=new s.Geom.Rectangle(0,0,u,d);this.setBackgroundShape(S),this.setBackgroundColor(n),this.lineStyle(o,r,1),this.strokeRectShape(S),p&&(this.setInteractive(S,s.Geom.Rectangle.Contains),this.on("pointerup",p)),this.setDepth(c),this.setAlpha(x),y&&v&&(this.on("pointerover",y),this.on("pointerout",v))}};function kt(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var _t=class extends Ot{constructor(e){var{scene:t,x:i=0,y:a=0,textColor:n="#FFFFFF",backgroundColor:r=f,marginColor:o=b,marginSize:l=0,paddingSize:h=0,fontSize:c=y,visible:u=!0,active:d=!0,text:p="",width:g,uppercase:m=!1,centralized:v=!0,onClickCallback:x,spriteKey:S,onPointerOver:w,onPointerOut:O,alpha:C=1}=e;super({scene:t,x:i,y:a,visible:u,active:d,spriteKey:S}),kt(this,"setBackgroundTextGraphic",e=>{this.backgroundTextGraphic=e}),kt(this,"setGameTextSprite",e=>{this.gameTextSprite=e}),kt(this,"setOnPointerOver",e=>{this.onPointerOver=e,this.on("pointerover",e)}),kt(this,"setOnPointerOut",e=>{this.onPointerOut=e,this.on("pointerout",e)}),kt(this,"setSelected",e=>{this.selected=e,e&&this.onSelectedOn?this.onSelectedOn():this.onSelectedOff&&this.onSelectedOff()}),kt(this,"setOnSelectedOn",e=>{this.onSelectedOn=e}),kt(this,"setOnSelectedOff",e=>{this.onSelectedOff=e});var P=new gt({scene:t,x:0,y:0,fontSize:c,text:p,originX:0,originY:0,color:n,uppercase:m}),{height:k,width:_}=P.getBounds(),T=k;g||(g=_+h),g+=h,v&&P.setX((g-_)/2),this.setGameTextSprite(P);var j=new Pt({scene:t,x:0,y:0,backgroundColor:r,marginColor:o,marginSize:l,width:g,height:T,spriteKey:S});if(this.setBackgroundTextGraphic(j),this.add(j),this.add(P),this.setCustomBounds({x:i,y:a,width:g+l,height:T+l}),x){var B=new s.Geom.Rectangle(0,0,g+l,T+l);this.setInteractive(B,s.Geom.Rectangle.Contains),this.onClickCallback=x,this.on("pointerup",x)}this.setDepth(170),this.setAlpha(C),w&&O&&(this.setOnPointerOut(O),this.setOnPointerOver(w))}};function Tt(){var e=this.data.get("playerNickname");be.call(this,e)?Bt.call(this):this.time.delayedCall(2e3,()=>pe.call(this,jt))}function jt(e){var{body:t}=e,{game:i}=t,{pendingPlayers:s}=i;this.data.get("pendingPlayers")!==s&&this.data.set("pendingPlayers",s),Tt.call(this)}function Bt(){if(window.gameSettings.enableGameDebug)return console.log("fetchRequestPaths"),void i.e(/*! import() */6).then(i.t.bind(null,/*! ../../requests/request-paths */19,3)).then(e=>{Mt.call(this,{body:e})});var e=Object(he.a)("moving-phase/request-paths"),t={nickname:this.data.get("playerNickname"),heroType:this.data.get("heroType"),gameId:this.data.get("gameId")};Object(he.b)(e,t).then(Mt.bind(this))}function Mt(e){var{body:t}=e,{game:i,actions:s}=t;this.data.set("heroActions",s);var a=ye.call(this),{x:n,y:r}=a,{x:o,y:l}=a.getBoardTilePosition();this.data.set("heroActionsInitialPosition",{position:{x:n,y:r},boardTilePosition:{x:o,y:l}});var h=s.filter(e=>{var{action:t}=e;return"move"===t}).sort((e,t)=>{var i,s;return(null===(i=e.position)||void 0===i?void 0:i.x)-(null===(s=t.position)||void 0===s?void 0:s.x)}),c=s.filter(e=>{var{action:t}=e;return"move"!==t});this.data.set("availableHeroActions",c),this.data.set("heroMovement",h),me.call(this,e);var u=Ht.call(this),d=new I({scene:this,children:u});this.setState({movingAreasGroupSprite:d});var p=Jt.call(this);Et.call(this,p),this.input.keyboard.on("keydown",Ft)}function At(){if(window.gameSettings.enableGameDebug)return console.log("fetchMove"),void i.e(/*! import() */5).then(i.t.bind(null,/*! ../../requests/move */20,3)).then(e=>{It.call(this,{body:e})});var e=Object(he.a)("moving-phase/move"),t={nickname:this.data.get("playerNickname"),heroType:this.data.get("heroType"),actions:this.data.get("heroPickedMovements"),gameId:this.data.get("gameId")};Object(he.b)(e,t).then(It.bind(this))}function It(e){this.data.set("heroPickedMovements",[]);var{body:t}=e,{game:i}=t,{turnPhase:s,pendingPlayers:a}=i;this.data.get("pendingPlayers")!==a&&this.data.set("pendingPlayers",a),this.data.get("nextTurnPhase")!==s?(me.call(this,e),this.data.set("nextTurnPhase",s),this.data.set("turnPhase",s)):this.time.delayedCall(2e3,()=>pe.call(this,It.bind(this)))}function Gt(){var e=Jt.call(this);console.log({actionsForMyPosition:e});var t=e.find(e=>e.mandatory);(null==t?void 0:t.mandatory)||e.push({action:"confirm"}),Et.call(this,e,!0),S(this.state.movingAreasGroupSprite)&&this.state.movingAreasGroupSprite.setGroupVisible(!1)}function Dt(){this.state.actionMenuItemsSprite.length&&this.state.actionMenuItemsSprite.forEach(e=>{e.destroy()})}function Et(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Dt.call(this),t&&e.push({action:"cancel"});var i=zt.call(this,e);this.setState({actionMenuItemsSprite:i})}function Kt(e,t,i){Dt.call(this);var s=this.data.get("heroPickedMovements")||[],a=Qt.call(this,t,i);s.push(a),this.data.set("heroPickedMovements",s);var n=ye.call(this);ze.call(n,t,i,e,Gt.bind(this))}function zt(e){var{height:t,width:i,y:s}=this.state.mainGameMapSprite.getCustomBounds(),a=t+s+g/2,n=0,r=[];return e.forEach(e=>{var{actionId:t,actionKey:s,onClickCallback:o}=Zt.call(this,e),l=new _t({scene:this,y:a+n,text:$t.call(this,s),spriteKey:"".concat(s,"_").concat(t),uppercase:!1,marginSize:2,fontSize:y,width:i,onClickCallback:o});l.verticallyCenterObject(),l.setOnPointerOver(()=>{l.setSelected(!0)}),l.setOnPointerOut(()=>{l.setSelected(!1)}),l.setOnSelectedOn(()=>{l.setScale(1.02)}),l.setOnSelectedOff(()=>{l.setScale(1)}),this.add.existing(l),r.push(l);var{height:h}=l.getCustomBounds();n+=h+4}),r}function Ht(){var e=this.data.get("heroMovement"),{height:t,width:i}=this.data.get("boardSize"),s=B(t,i,e),a=[],n=this;return e.forEach((e,t)=>{var{position:i}=e,{x:r,y:o}=ue.call(n,i.x,i.y),l=new rt({scene:n,x:r,y:o,boardTilePosition:i,gridSize:8,height:4,width:4,backgroundColor:13681876,alpha:.6,depth:60,visible:!1,onClickCallback:()=>{var{x:e,y:t}=i;console.log("click click",{walkableMapArray:s,newX:e,newY:t}),Kt.call(n,s,e,t)}});n.add.existing(l),a.push(l),n.time.delayedCall(100+20*t,()=>{l.setVisible(!0)})}),n.input.keyboard.on("keydown",Xt),a}function Nt(){var e=this.data.get("heroTeleportMovement"),t=[],i=this;return e.forEach((e,s)=>{var{position:a}=e,{x:n,y:r}=ue.call(i,a.x,a.y),o=new rt({scene:i,x:n,y:r,boardTilePosition:a,gridSize:8,height:4,width:4,backgroundColor:11767231,alpha:.6,depth:60,visible:!1,onClickCallback:()=>{var t=n+g/2,i=r+g,s=this.data.get("heroPickedMovements")||[];s.push(e),this.data.set("heroPickedMovements",s);var o=ye.call(this);o.setPosition(t,i),o.setBoardTilePosition(a.x,a.y),S(this.state.movingTeleportAreasGroupSprite)&&this.state.movingTeleportAreasGroupSprite.setGroupVisible(!1);var l=Jt.call(this),h=l.find(e=>e.mandatory);(null==h?void 0:h.mandatory)||l.push({action:"confirm"}),Et.call(this,l,!0),console.log({actionsForMyPosition:l})}});i.add.existing(o),t.push(o),i.time.delayedCall(100+20*s,()=>{o.setVisible(!0)})}),i.input.keyboard.on("keydown",Xt),t}function Xt(e){var t,{scene:i}=this,{key:s}=e;if(null===(t=i.state.boardCursorSprite)||void 0===t?void 0:t.visible){var a=i.data.get("heroMovement"),{height:n,width:r}=i.data.get("boardSize"),o=B(n,r,a),{x:l,y:h}=i.state.boardCursorSprite.getBoardTilePosition(),c=Boolean(o[h-1][l-1]);i.state.movingAreasGroupSprite.groupVisible&&c&&_(s)&&Kt.call(i,o,l,h)}}function Ft(e){var t,{scene:i}=this;(null===(t=i.state.boardCursorSprite)||void 0===t?void 0:t.visible)||S(i.state.actionMenuItemsSprite)&&ge(e,i.state.actionMenuItemsSprite)}function Yt(){var e,t;console.log("CancelAction"),this.data.set("heroPickedMovements",[]),this.state.movingAreasGroupSprite.setGroupVisible(!0),null===(e=this.state.movingTeleportAreasGroupSprite)||void 0===e||null===(t=e.setGroupVisible)||void 0===t||t.call(e,!1);var{position:i,boardTilePosition:s}=this.data.get("heroActionsInitialPosition"),a=ye.call(this);a.setBoardTilePosition(s.x,s.y),a.setX(i.x),a.setY(i.y);var n=Jt.call(this);Et.call(this,n)}function Rt(){console.log("ConfirmAction"),Dt.call(this),this.input.keyboard.off("keydown",Ft),this.input.keyboard.off("keydown",Xt),this.setState({actionMenuItemsSprite:[]}),this.data.set("availableHeroActions",[]),S(this.state.movingAreasGroupSprite)&&(this.state.movingAreasGroupSprite.destroy(!0),this.setState({movingAreasGroupSprite:[]})),S(this.state.movingTeleportAreasGroupSprite)&&(this.state.movingTeleportAreasGroupSprite.destroy(!0),this.setState({movingTeleportAreasGroupSprite:[]})),At.call(this)}function Vt(e){console.log("NoAction"),this.data.set("heroPickedMovements",e),Rt.call(this)}function Lt(){console.log("PunchAction")}function Wt(){console.log("TrampolineAction")}function qt(){console.log("InvisibilityCapeAction")}function Ut(e){var{actions:t}=e,i=t.filter(e=>{var{action:t}=e;return"move"===t}).sort((e,t)=>{var i,s;return(null===(i=e.position)||void 0===i?void 0:i.x)-(null===(s=t.position)||void 0===s?void 0:s.x)}),s=t.filter(e=>{var{action:t}=e;return"move"!==t});this.data.set("heroTeleportMovement",i),s.push({action:"cancel"});var a=this.data.get("heroPickedMovements")||[];if(a.push(e),this.data.set("heroPickedMovements",a),Et.call(this,s),S(this.state.movingTeleportAreasGroupSprite))this.state.movingTeleportAreasGroupSprite.setGroupVisible(!0);else{var n=Nt.call(this),r=new I({scene:this,children:n});this.setState({movingTeleportAreasGroupSprite:r})}}function Jt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=ye.call(this),{x:i,y:s}=t.getBoardTilePosition(),a=e;return a||(a=this.data.get("availableHeroActions")),a.filter(e=>{var{position:t}=e,{x:a,y:n}=t;return i===a&&s===n})}function Qt(e,t){return this.data.get("heroMovement").find(i=>{var{position:s}=i,{x:a,y:n}=s;return e===a&&t===n})}function Zt(e){var{action:t,itemId:i}=e,s=()=>{};switch(t){case"no_action":s=()=>Vt.call(this,e);break;case"punch":s=Lt.bind(this);break;case"trampoline":s=Wt.bind(this);break;case"invisibility_cape":s=qt.bind(this);break;case"portal_gun":s=()=>Ut.call(this,e);break;case"cancel":s=Yt.bind(this);break;case"confirm":s=Rt.bind(this)}return{actionKey:t,actionId:i,onClickCallback:s}}function $t(e){return n.default.t(e)}var ei=class extends mt{constructor(e){var{scene:t,x:i=0,y:s=0,asset:a="bomb_target_position"}=e;super({scene:t,x:i,y:s,asset:a}),Object.assign(this,{setBoardTilePosition:Ze,getBoardTilePosition:$e}),this.setDepth(120),this.setOrigin(0,0)}};function ti(){this.input.keyboard.on("keydown",ii),this.input.on("pointerup",si)}function ii(e){var{scene:t}=this,{key:i}=e;if(_(i)){var{x:s,y:a}=t.state.boardCursorSprite.getBoardTilePosition();ai.call(t,s,a)}}function si(e){var{scene:t}=this;if(e.scene=t,e.getCustomBounds=Xe,e.getBounds=()=>({height:0,width:0,x:e.x,y:e.y}),Ee.call(e)){var{x:i,y:s}=e;if(S(t.state.boardCursorSprite)){var a=t.state.boardCursorSprite.getBoardTilePosition();i=a.x,s=a.y}else{var n=de.call(t,e.x,e.y);i=n.x,s=n.y}ai.call(t,i,s)}}function ai(e,t){var{bombTargetsSprite:i=[]}=this.state,s=this.data.get("heroPickedBombsPositions")||[];if(console.log({length:s.length,pickedPositions:s,bombTargetsSprite:i}),s.length<2){s.push({x:e,y:t}),this.data.set("heroPickedBombsPositions",s);var a="bomb_target_position";if(1===i.length){var n,{x:r,y:o}=null===(n=i[0])||void 0===n?void 0:n.getBoardTilePosition();r===e&&o===t&&(a="bomb_target_position_doubled")}var{x:l,y:h}=ue.call(this,e,t),c=new ei({scene:this,x:l,y:h,asset:a});c.setBoardTilePosition(e,t),i.push(c),this.add.existing(c),this.setState({bombTargetsSprite:i})}2===s.length&&(this.input.keyboard.off("keydown",ii),this.input.off("pointerup",si),ni.call(this))}function ni(){if(window.gameSettings.enableGameDebug)return console.log("fetchDropBombs"),void i.e(/*! import() */2).then(i.t.bind(null,/*! ../../requests/drop-bombs */21,3)).then(e=>{ri.call(this,{body:e})});var e=Object(he.a)("bombs-phase/drop-bombs"),t={nickname:this.data.get("playerNickname"),heroType:this.data.get("heroType"),bombs:this.data.get("heroPickedBombsPositions"),gameId:this.data.get("gameId")};Object(he.b)(e,t).then(ri.bind(this))}function ri(e){this.data.set("heroPickedBombsPositions",[]);var{bombTargetsSprite:t}=this.state;t.forEach(e=>{e.destroy()}),this.setState({bombTargetsSprite:[]});var{body:i}=e,{game:s}=i,{turnPhase:a,pendingPlayers:n}=s;this.data.get("pendingPlayers")!==n&&this.data.set("pendingPlayers",n),this.data.get("nextTurnPhase")!==a?(me.call(this,e),this.data.set("nextTurnPhase",a),this.data.set("turnPhase",a)):this.time.delayedCall(2e3,()=>pe.call(this,ri.bind(this)))}var oi=class extends lt{constructor(e){var{scene:t,x:i=0,y:s=0,asset:a,setSpriteTint:n=!0,heroColor:r,tilePosition:o}=e;if(super({scene:t,x:i,y:s,asset:a}),Object.assign(this,{setHeroColor:Je}),this.setDepth(40),this.setOrigin(0,0),this.setHeroColor(r),n){var l=ae(r);this.setTint(l)}}};var li=class extends lt{constructor(e){var{scene:t,x:i=0,y:s=0,originX:a=0,originY:n=0,asset:r,setSpriteTint:o=!0,frame:l="block",heroColor:h,tilePosition:c,isSpecialBlock:u}=e;super({scene:t,x:i,y:s,asset:r,frame:l}),Object.assign(this,{setBoardTilePosition:Ze}),this.setDepth(45),this.setOrigin(a,n),this.setHeroColor(h),this.setIsSpecialBlock(u),c&&this.setBoardTilePosition(c.x,c.y),o&&this.setSpriteTint(h)}setHeroColor(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Je.call(this,e),t&&this.setSpriteTint(e)}setSpriteTint(e){var t=ae(e);this.setTint(t)}setIsSpecialBlock(e){this.isSpecialBlock=e;var t=e?"special_block":"block",{originX:i,originY:s}=this;this.setFrame(t),this.setOrigin(i,s)}};var hi=class extends lt{constructor(e){var{scene:t,x:i=0,y:s=0,asset:a,heroColor:n,setSpriteTint:r=!0,tilePosition:o,frame:l="flag_idle_01"}=e;if(super({scene:t,x:i,y:s,asset:a,frame:l}),Object.assign(this,{setHeroColor:Je}),this.setDepth(80),this.setOrigin(0,0),this.setHeroColor(n),r){var h=ae(n);this.setTint(h)}}};function ci(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var ui=class extends lt{constructor(e){var{scene:t,x:i=0,y:s=0,heroType:a,health:n,mana:r,invisible:o,asset:l="hero_0".concat(a),heroColor:h,tilePosition:c,frame:u="idle_01"}=e;super({scene:t,x:i,y:s,asset:l,frame:u}),ci(this,"setIsInvisibleOnBoard",e=>{this.isInvisibleOnBoard=e}),ci(this,"setHealth",e=>{this.health=e}),ci(this,"setMana",e=>{this.mana=e}),ci(this,"createAnimations",()=>{var e=this.texture.key;this.scene.anims.exists("".concat(e,"_idle"))||this.scene.anims.create({key:"".concat(e,"_idle"),frames:this.scene.anims.generateFrameNames(e,{frames:["idle_01","idle_02","idle_03","idle_04"]}),frameRate:6,repeat:-1}),this.scene.anims.exists("".concat(e,"_walk"))||this.scene.anims.create({key:"".concat(e,"_walk"),frames:this.scene.anims.generateFrameNames(e,{frames:["walking_01","walking_02","walking_03","walking_04"]}),frameRate:10,repeat:-1}),this.scene.anims.exists("".concat(e,"_jump"))||this.scene.anims.create({key:"".concat(e,"_jump"),frames:this.scene.anims.generateFrameNames(e,{frames:["jumping_01","jumping_02","jumping_03","jumping_04","jumping_05","jumping_06","jumping_07"]}),frameRate:12,repeat:-1})}),ci(this,"setAnimation",e=>{if(this.currentAnimationName!==e){var t=this.texture.key,i="".concat(t,"_").concat(e);this.currentAnimationName=e,this.currentAnimationKey=i,this.anims.play(i)}}),ci(this,"moveToBoardTilePosition",(e,t,i,s,a)=>{var{scene:n}=this,{x:r,y:o}=ue.call(n,e,t);r+=g/2,o+=g,this.moveToPosition(r,o,i,s,()=>{this.setBoardTilePosition(e,t),a&&a()})}),ci(this,"moveToPosition",(e,t,i,s,a)=>{i?this.setAnimation(i):this.setAnimation("walk"),this.scene.tweens.add({x:e,y:t,targets:this,t:1,ease:"Linear",duration:200,repeat:0,yoyo:!1,onComplete:e=>{s?this.setAnimation(s):this.setAnimation("idle"),e.stop(),a&&a()}})}),Object.assign(this,{setHeroColor:Je,getBoardTilePosition:$e,setBoardTilePosition:Ze}),this.setDepth(90),this.setOrigin(.5,1),this.setHeroColor(h),this.createAnimations(),this.setAnimation("idle"),this.setBoardTilePosition(c.x,c.y),this.setMana(r),this.setHealth(n),this.setIsInvisibleOnBoard(o)}};function di(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var pi=class extends lt{constructor(e){var{scene:t,x:i=0,y:s=0,asset:a,tilePosition:n,willDieNextTurn:r,itemType:o,frame:l,spriteKey:h}=e;super({scene:t,x:i,y:s,asset:a,frame:l}),di(this,"setWillDieNextTurn",e=>{this.willDieNextTurn=e}),di(this,"setItemType",e=>{this.itemType=e}),di(this,"createAnimations",()=>{var e=this.texture.key;this.scene.anims.exists("".concat(e,"_idle"))||this.scene.anims.create({key:"".concat(e,"_idle"),frames:this.scene.anims.generateFrameNames(e,{frames:["item_idle_01","item_idle_02","item_idle_03"]}),frameRate:3,yoyo:!0,repeat:-1})}),di(this,"setAnimation",e=>{if(this.currentAnimationName!==e){var t=this.texture.key,i="".concat(t,"_").concat(e);this.currentAnimationName=e,this.currentAnimationKey=i,this.anims.play(i)}}),this.setDepth(70),this.setOrigin(0,0),this.setWillDieNextTurn(r),this.setItemType(o),this.createAnimations(),this.setSpriteKey(h),t.time.delayedCall(Math.floor(200*Math.random())+30,()=>this.setAnimation.call(this,"idle"))}};var gi=class extends pi{constructor(e){var{scene:t,x:i=0,y:s=0,tilePosition:a={x:0,y:0},asset:n="trampoline",frame:r="item_idle_01",willDieNextTurn:o=!1,spriteKey:l}=e;super({scene:t,x:i,y:s,tilePosition:a,asset:n,willDieNextTurn:o,spriteKey:l,itemType:"trampoline"})}};var yi=class extends pi{constructor(e){var{scene:t,x:i=0,y:s=0,tilePosition:a={x:0,y:0},asset:n="invisibility_cape",frame:r="item_idle_01",willDieNextTurn:o=!1,spriteKey:l}=e;super({scene:t,x:i,y:s,tilePosition:a,asset:n,willDieNextTurn:o,spriteKey:l,itemType:"invisibility_cape"})}};var mi=class extends pi{constructor(e){var{scene:t,x:i=0,y:s=0,tilePosition:a={x:0,y:0},asset:n="portal_gun",frame:r="item_idle_01",willDieNextTurn:o=!1,spriteKey:l}=e;super({scene:t,x:i,y:s,tilePosition:a,asset:n,willDieNextTurn:o,spriteKey:l,itemType:"portal_gun"})}};class fi extends s.GameObjects.Polygon{constructor(e){var{scene:t,x:i=0,y:s=0,points:a,spriteKey:n}=e;super(t,i,s,a),Object.assign(this,{setSpriteKey:He,verticallyCenterObject:Fe,setCustomBounds:Ne,getCustomBounds:Xe}),this.setSpriteKey(n),this.setOrigin(0,0)}}var bi=fi;function vi(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var xi=class extends bi{constructor(e){var t,{scene:i,tetrominoType:s,heroColor:a,x:n=0,y:r=0,originX:o=se,originY:l=se,tetrominoArray:h=le(s),points:c=oe(s),spriteKey:u}=e;super({scene:i,x:n,y:r,points:c,spriteKey:u}),t=this,vi(this,"setMainColor",e=>{this.mainColor=e}),vi(this,"setBlockedColor",e=>{this.blockedColor=e}),vi(this,"setManaColor",e=>{this.manaColor=e}),vi(this,"setPositionState",e=>{switch(this.positionState=e,e){case 1:this.setFillStyle(this.blockedColor),this.setAlpha(.8);break;case 2:this.setFillStyle(this.manaColor),this.setAlpha(.8);break;case 0:default:this.setFillStyle(this.mainColor),this.setAlpha(.5)}}),vi(this,"calculateTetrominoShadowBoardPositionFromPosition",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,{height:s,width:a}=t.getCustomBounds(),n=Math.round(a)/g%2==1,r=Math.round(s)/g%2==1,o=e,l=i;return n&&(o+=g/2),r&&(l+=g/2),o=Math.floor(o/g)*g,l=Math.floor(l/g)*g,n||(o+=g/2),r||(l+=g/2),{x:o,y:l}})),Object.assign(this,{verticallyCenterOriginOffsetObject:Ye,getInitialPosition:Re,setInitialPosition:Ve,setTetrominoType:Qe,setTetrominoArray:qe,setHeroColor:Je});this.setFillStyle(0),this.setMainColor(0),this.setBlockedColor(7021090),this.setManaColor(4223280),this.setStrokeStyle(.5,(e=>{switch(e){case 2:return 2099722;case 3:return 1253646;case 4:return 992045;case 1:return 4207633;default:return null}})(a)),this.setAlpha(.5),this.setDepth(100),this.setOrigin(o,l),this.setVisible(!1),this.setHeroColor(a),this.setTetrominoType(s),this.setTetrominoArray(h)}};function Si(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var wi=class extends Ot{constructor(e){var{scene:t,tetrominoShadow:i,tetrominoType:a,heroColor:n,x:r=0,y:o=0,spriteKey:l,tetrominoArray:h=le(a),onDrag:c=_e,onDragEnd:u=Te,onDragStart:d=ke,onPointerUp:p=Ce,onPointerDown:y=Pe,useKeyboardControls:m=!0,onDrop:f=Ke}=e;super({scene:t,x:r,y:o,spriteKey:l}),Si(this,"removeInputListener",()=>{this.removeAllListeners(),this.scene.input.keyboard.off("keydown",this.onKeyDown)}),Si(this,"onKeyDown",e=>{var{key:t}=e,{scene:i}=this;if(P(t)||_(t)||j(t)||k(t)||C(t)||T(t)||O(t)){if(j(t))return this.resetTetrominoToInitialPosition(),this.resetIsMoving(),this.setIndividualChildScale(1),this.setScale(1),void(S(i.state.boardCursorSprite)&&i.state.boardCursorSprite.activateCursor());if(T(t))this.rotateTetromino();else{if(_(t))return this.onDrop(),void(S(i.state.boardCursorSprite)&&i.state.boardCursorSprite.activateCursor());var{tetrominoShadow:s}=this;if(Ee.call(s)){var a=O(t),n=C(t),r=P(t),o=k(t),{x:l,y:h}=s;if(a)h=s.y-g;else if(n)l=s.x+g;else if(r)h=s.y+g;else{if(!o)return;l=s.x-g}var{x:c,y:u}=this,{x:d,y:p}=s;this.setX(l-g/2),this.setY(h-g/2),s.setX(l),s.setY(h),Ee.call(s)||(this.setX(c),this.setY(u),s.setX(d),s.setY(p))}else{var{width:y,height:m,x:f,y:b}=i.state.mainGameMapSprite.getCustomBounds(),v=y/2+f,x=m+b-g,{tetrominoArray:w}=this,B=w[0].length%2==1;w.length%2==1||(x-=g/2),B&&(v-=g/2),this.setX(v),this.setY(x),this.setIndividualChildScale(.9),this.setScale(1/.9);var{x:M,y:A}=s.calculateTetrominoShadowBoardPositionFromPosition(v,x);s.setY(A),s.setX(M),s.setVisible(!0),Ee.call(s)||(this.setY(this.y-g),s.setY(s.y-g));var I=Be.call(s);s.setPositionState(I),this.setIsMovingWithKeyboard(!0),S(i.state.boardCursorSprite)&&i.state.boardCursorSprite.deactivateCursor()}var G=Be.call(s);s.setPositionState(G)}}}),Si(this,"setTetrominoShadow",e=>{this.tetrominoShadow=e}),Si(this,"createChildSprites",()=>{var e=0,t=0,i=se,s=g-g*i;this.tetrominoArray.forEach((a,n)=>{a.forEach((a,n)=>{if(a){var r=new li({scene:this.scene,heroColor:this.heroColor,asset:"blocks",frame:"block",x:e+s,y:t+s,originX:i,originY:i});this.add(r)}e+=g}),t+=g,e=0})}),Si(this,"rotateTetromino",()=>{var{tetrominoShadow:e}=this;this.setAngle(this.angle+90),e.setAngle(e.angle+90);var t=(e=>{for(var t=[],i=function(i){var s=e.map(e=>e[i]).reverse();t.push(s)},s=0;s<e[0].length;s++)i(s);return t})([...this.tetrominoArray]);if(this.setTetrominoArray(t),e.setTetrominoArray(t),Ee.call(e)){var i=t[0].length%2==1,s=t.length%2==1;i&&(this.setX(this.x-g/2),this.setY(this.y-g/2),e.setX(e.x-g/2),e.setY(e.y-g/2)),s&&(this.setX(this.x+g/2),this.setY(this.y+g/2),e.setX(e.x+g/2),e.setY(e.y+g/2))}if(this.isMovingWithKeyboard||this.isMovingWithMouse){window.tetrominoShadow=e,window.isRightOfTheGameBoard=Ie,Ie.call(e)||Ae.call(e)?(this.setX(this.x-g/2),this.setY(this.y-g/2),e.setX(e.x-g/2),e.setY(e.y-g/2)):(De.call(e)||Ge.call(e))&&(this.setX(this.x+g/2),this.setY(this.y+g/2),e.setX(e.x+g/2),e.setY(e.y+g/2));var a=Be.call(e);e.setPositionState(a)}}),Si(this,"setIsMovingWithKeyboard",e=>{this.isMovingWithKeyboard=e}),Si(this,"setIsMovingWithMouse",e=>{this.isMovingWithMouse=e}),Si(this,"resetIsMoving",()=>{this.setIsMovingWithKeyboard(!1),this.setIsMovingWithMouse(!1)}),Si(this,"resetTetrominoToInitialPosition",()=>{var{tetrominoShadow:e}=this,{x:t,y:i}=this.getInitialPosition();this.setX(t),this.setY(i),e.setX(t),e.setY(i),e.setVisible(!1)}),Object.assign(this,{verticallyCenterOriginOffsetObject:Ye,getInitialPosition:Re,setInitialPosition:Ve,setTetrominoType:Qe,setTetrominoArray:qe,setHeroColor:Je}),this.setTetrominoShadow(i),this.setTetrominoArray(h),this.setTetrominoType(a),this.setHeroColor(n),this.createChildSprites(),this.centralizeChildren();var{width:b,height:v}=this.getBounds(),x=new s.Geom.Rectangle(0-b*se,0-v*se,b,v);this.setInteractive(x,s.Geom.Rectangle.Contains),t.input.dragDistanceThreshold=3,t.input.setDraggable(this),this.onDrop=f,this.on("drag",c.bind(this)),this.on("dragend",e=>u.call(this,e)),this.on("dragstart",d.bind(this)),this.on("pointerdown",y.bind(this)),this.setDepth(110),m&&t.input.keyboard.on("keydown",this.onKeyDown)}};function Oi(e,t){if(window.gameSettings.enableGameDebug)return console.log("fetchStartGame"),void i.e(/*! import() */7).then(i.t.bind(null,/*! ../../requests/start-game */18,3)).then(t=>{Ci.call(this,{body:t}),e()});var s=Object(he.a)("start-game"),a={heroType:this.data.get("heroType"),nickname:this.data.get("playerNickname"),gameId:this.data.get("gameId")};Object(he.b)(s,a).then(Ci.bind(this)).then(e)}function Ci(e){var{body:t}=e,{game:i,players:s}=t;if(null==i?void 0:i.turnPhase){var{board:a,turnPhase:n}=i,{blockMap:r}=a;this.data.set("raw_data",t),this.data.set("playersList",s);var o=ce.call(this),{heroColor:l}=o,h=r.length,c=r[0].length;this.data.set("boardSize",{height:h,width:c}),this.data.set("nextTurnPhase",n),this.createAfterData(),this.data.set("heroColor",l),me.call(this,e)}else this.time.delayedCall(2e3,()=>pe.call(this,Ci.bind(this)))}function Pi(e,t){return function(e){return e.map((t,i)=>0===i?[0,...Array(t.length-2).fill(1),2]:i===e.length-1?[18,...Array(t.length-2).fill(19),20]:[9,...t.slice(2),11])}(x(e,t,10))}function ki(e,t,i){switch(t){case"bases":Gi(e,i);break;case"blockMap":Ii(e,i);break;case"flags":Ai(e,i);break;case"heroes":Mi(e,i);break;case"items":Bi(e,i);break;case"turnPhase":ji(e,i);break;case"tetrominoType":Ti(e,i)}}function _i(){this.data.events.on("setdata",ki),this.data.events.on("changedata-".concat("blockMap"),Ii),this.data.events.on("changedata-".concat("bases"),Gi),this.data.events.on("changedata-".concat("flags"),Ai),this.data.events.on("changedata-".concat("heroes"),Mi),this.data.events.on("changedata-".concat("items"),Bi),this.data.events.on("changedata-".concat("turnPhase"),ji),this.data.events.on("changedata-".concat("tetrominoType"),Ti)}var Ti=(e,t,i)=>{if(null!==t&&!xt()(t,i)){var{height:s,width:a,y:n}=e.state.mainGameMapSprite.getCustomBounds(),r=s+n+g,o=new Pt({scene:e,y:r,width:a,height:5*g,marginSize:4,depth:95});o.verticallyCenterObject(),e.add.existing(o),e.setState({tetrominoGameBoxSprite:o});var l=e.data.get("heroColor"),h=new xi({scene:e,tetrominoType:t,heroColor:l});h.verticallyCenterOriginOffsetObject(),e.add.existing(h);var c=new wi({scene:e,tetrominoShadow:h,tetrominoType:t,heroColor:l});c.verticallyCenterOriginOffsetObject(),e.add.existing(c);var{height:u}=o.getCustomBounds(),d=r+u/2;h.setInitialPosition({x:h.x,y:d}),c.setInitialPosition({x:c.x,y:d})}},ji=(e,t,i)=>{if(null!==t&&!xt()(t,i)&&!e.data.get("playerIsViewer"))switch(t){case 1:console.log("GAME_PHASE_PUT_BLOCKS"),ve.call(e);break;case 2:console.log("GAME_PHASE_MOVE_HERO"),Tt.call(e);break;case 3:console.log("GAME_PHASE_SHOOT_BOMBS"),ti.call(e)}},Bi=(e,t,i)=>{if(!xt()(t,i)){var s=t,{sceneItemsSprite:a}=e.state;if(S(a)){var n=a.map(e=>e.spriteKey);s=s.filter(e=>!n.includes(e.id)),n.forEach(e=>{t.find(t=>t.id===e)||a.find(t=>t.id===e).destroy()})}s.forEach(t=>{var i=Di(e,t);e.add.existing(i),a.push(i)}),e.setState({sceneItemsSprite:a})}},Mi=(e,t,i)=>{if(!xt()(t,i)){var{sceneHeroesSprite:s=[]}=e.state;S(s)?t.forEach(t=>{var{health:i,mana:a,heroColor:n,invisible:r,tilePosition:o}=t,{x:l,y:h}=o,c=s.find(e=>e.heroColor===n),{x:u,y:d}=c.getBoardTilePosition();if(u!==l||d!==h){var{height:p,width:g}=e.data.get("boardSize"),y=x(p,g,1);ze.call(c,l,h,y)}c.health,c.mana,c.isInvisibleOnBoard,c.isInvisibleOnBoard}):(t.forEach(t=>{var{tilePosition:i,heroColor:a,heroType:n,health:r,mana:o,invisible:l}=t,{x:h,y:c}=ue.call(e,i.x,i.y),u=new ui({scene:e,heroColor:a,x:h+g/2,y:c+g,health:r,mana:o,invisible:l,heroType:n,tilePosition:i});e.add.existing(u),s.push(u)}),e.setState({sceneHeroesSprite:s}))}},Ai=(e,t,i)=>{if(!xt()(t,i)){var{sceneFlagsSprite:s}=e.state;S(s),t.forEach(t=>{var{tilePosition:i,heroColor:a}=t,{x:n,y:r}=ue.call(e,i.x,i.y),o=new hi({scene:e,heroColor:a,asset:"flag",x:n,y:r});e.add.existing(o),s.push(o)}),e.setState({sceneFlagsSprite:s})}},Ii=(e,t,i)=>{if(!xt()(t,i)){var{sceneBlocksSprite:s=[]}=e.state;if(S(s))t.flat().forEach((e,t)=>{var i=s[t],a=ne(e),n=re(e);e?(i.heroColor!==a&&(i.heroColor||i.setVisible(!0),i.setHeroColor(a)),i.isSpecialBlock!==n&&i.setIsSpecialBlock(n)):i.setVisible(!1)});else t.forEach((t,i)=>{t.forEach((t,a)=>{var n=a+1,r=i+1,{x:o,y:l}=ue.call(e,n,r),h=ne(t),c=re(t),u=new li({scene:e,heroColor:h,asset:"blocks",isSpecialBlock:c,x:o,y:l,tilePosition:{x:n,y:r}});h||u.setVisible(!1),e.add.existing(u),s.push(u)})}),e.setState({sceneBlocksSprite:s})}},Gi=(e,t,i)=>{if(!xt()(t,i)){var{sceneBasesSprite:s}=e.state;S(s),t.forEach(t=>{var{tilePosition:i,heroColor:a}=t,{x:n,y:r}=ue.call(e,i.x,i.y),o=new oi({scene:e,heroColor:a,asset:"hero_base",x:n,y:r});e.add.existing(o),s.push(o)}),e.setState({sceneBasesSprite:s}),e.data.set("totalBasesQuantity",t.length),e.data.set("currentBasesQuantity",t.length)}},Di=(e,t)=>{var{item:i,tilePosition:s,id:a}=t,{x:n,y:r}=ue.call(e,s.x,s.y);switch(i){case"portal_gun":return new mi({scene:e,x:n,y:r,spriteKey:a});case"invisibility_cape":return new yi({scene:e,x:n,y:r,spriteKey:a});default:case"trampoline":return new gi({scene:e,x:n,y:r,spriteKey:a})}},Ei=()=>p.isMobile?192:384,Ki=()=>p.isMobile?16:192;function zi(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var Hi=class extends z{constructor(){super("MainGameScene"),zi(this,"state",{loadingSprite:{},tetrominoGameBoxSprite:{},boardCursorSprite:{},loadingTextSprite:{},mainGameMapSprite:{},sceneBasesSprite:[],sceneBlocksSprite:[],sceneFlagsSprite:[],sceneHeroesSprite:[],sceneItemsSprite:[],movingAreasGroupSprite:{},movingTeleportAreasGroupSprite:{},actionMenuItemsSprite:[],bombTargetsSprite:[]}),zi(this,"createBeforeData",()=>{var e=new gt({scene:this,text:n.default.t("loading_game_data"),y:70,x:Ki(),spriteKey:"loading_game_data",uppercase:!0,fontSize:y,originX:0,originY:0});this.add.existing(e),this.setState({loadingTextSprite:e});var t=new ht({scene:this,y:230});t.verticallyCenterObject(),this.add.existing(t),this.setState({loadingSprite:t})}),zi(this,"createAfterData",()=>{S(this.state.loadingTextSprite,this.state.loadingSprite)&&(this.state.loadingTextSprite.setVisible(!1),this.state.loadingTextSprite.destroy(),this.state.loadingSprite.setVisible(!1),this.state.loadingSprite.destroy(),this.setState({loadingSprite:{}}),this.setState({loadingTextSprite:{}}));var{height:e,width:t}=this.data.get("boardSize"),i=Pi.call(this,e,t),s=new it({scene:this,data:i,tileWidth:g,tileHeight:g,width:t,height:e,layerName:"ground_base",tilesetName:"dungeon",asset:"tileset",y:16});s.verticallyCenterObject(),this.setState({mainGameMapSprite:s});var a=new rt({scene:this,height:e,width:t,y:16,depth:50});if(a.verticallyCenterObject(),this.add.existing(a),!p.isMobile){var{x:n,y:r}=window.gameSettings.mousePosition,o=new bt({scene:this,x:n,y:r});this.add.existing(o),this.setState({boardCursorSprite:o})}this.data.set("turnPhase",this.data.get("nextTurnPhase"))})}init(e){_i.call(this);var{gameId:t,nickname:i,heroType:s}=e;this.data.set("gameId",t),this.data.set("playerNickname",i),this.data.set("heroType",s)}preload(){this.load.rexAwait(Oi.bind(this))}create(){super.create(),this.data.get("boardSize")||this.createBeforeData()}};var Ni=class extends mt{constructor(e){var{scene:t,x:i=0,y:s=0,asset:a="pixel_heroes_logo"}=e;super({scene:t,x:i,y:s,asset:a}),this.setDepth(m),this.setOrigin(0,0)}};var Xi=class extends z{constructor(){var e,t,i;super("MainMenuScene"),i={pixelHeroesLogo:null,menuItemsSprite:[]},(t="state")in(e=this)?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}init(){this.handleSceneStart()}create(){super.create();var e=new Ni({scene:this});e.verticallyCenterObject(),this.add.existing(e),this.setState({pixelHeroesLogo:e});var t=[],i=new _t({scene:this,y:128,text:n.default.t("quick_play"),spriteKey:"quick_play",uppercase:!0,marginSize:2,fontSize:"30px",width:Ei(),onClickCallback:()=>{this.handleSceneEnd("HeroSelectionScene")}});fe.call(this,i),t.push(i);var s=new _t({scene:this,y:174,text:n.default.t("settings_menu"),spriteKey:"settings_menu",uppercase:!0,marginSize:2,fontSize:"30px",width:Ei(),onClickCallback:()=>{this.handleSceneEnd("SettingsScene")}});fe.call(this,s),t.push(s);var a=new _t({scene:this,y:220,text:n.default.t("debug_menu"),spriteKey:"debug_menu",uppercase:!0,marginSize:2,fontSize:"30px",width:Ei(),onClickCallback:()=>{this.handleSceneEnd("DebugMenuScene")}});fe.call(this,a),t.push(a),this.setState({menuItemsSprite:t});var r=new gt({scene:this,text:"V ".concat("0.0.1-alpha.9")});r.verticallyRightObject(),r.horizontallyBottomObject(),this.add.existing(r),this.input.keyboard.on("keydown",e=>{ge(e,t)})}};var Fi=class extends z{constructor(){var e,t,i;super("DebugMenuScene"),i={menuItemsSprite:[]},(t="state")in(e=this)?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}init(){window.gameSettings.enableGameDebug=!0}preload(){}create(){super.create();var e=[],t=new _t({scene:this,y:128,text:n.default.t("game_start"),spriteKey:"game_start",uppercase:!0,marginSize:2,fontSize:"30px",width:Ei(),onClickCallback:()=>{this.handleSceneEnd("MainGameScene",{gameId:"c6509855-e139-4d8b-9e4c-282d3cbe3a0a",heroType:9,nickname:"blopa"})}});fe.call(this,t),e.push(t),this.setState({menuItemsSprite:e}),this.input.keyboard.on("keydown",t=>{ge(t,e)})}};var Yi=class extends z{constructor(){var e,t,i;super("SettingsScene"),i={menuItemsSprite:[]},(t="state")in(e=this)?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}init(){window.gameSettings.enableGameDebug=!0}preload(){}create(){super.create();var e=new gt({scene:this,text:n.default.t("settings"),y:20,spriteKey:"waiting_for_players",uppercase:!0,fontSize:y,originX:0,originY:0});e.verticallyCenterObject(),this.add.existing(e);var t=[],i=new _t({scene:this,y:128,text:n.default.t("english"),spriteKey:"english",uppercase:!0,marginSize:2,fontSize:"30px",width:Ei(),onClickCallback:()=>{n.default.changeLanguage("en"),this.handleSceneEnd("MainMenuScene")}});fe.call(this,i),t.push(i);var s=new _t({scene:this,y:174,text:n.default.t("portuguese"),spriteKey:"portuguese",uppercase:!0,marginSize:2,fontSize:"30px",width:Ei(),onClickCallback:()=>{n.default.changeLanguage("pt-BR"),this.handleSceneEnd("MainMenuScene")}});fe.call(this,s),t.push(s),this.setState({menuItemsSprite:t}),this.input.keyboard.on("keydown",e=>{ge(e,t)})}};function Ri(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var Vi=class{constructor(e){var t=this,{scene:i,spriteKey:s,placeholder:a,width:n=0,height:r=0,fontSize:o,x:l=0,y:h=0}=e;Ri(this,"setPlaceholder",e=>{this.placeholder=e}),Ri(this,"setWidth",e=>{this.width=e}),Ri(this,"setHeight",e=>{this.height=e}),Ri(this,"setY",e=>{this.y=e}),Ri(this,"setX",e=>{this.x=e}),Ri(this,"setFontSize",e=>{this.fontSize=e}),Ri(this,"setTextfield",e=>{this.textfield=e}),Ri(this,"setScene",e=>{this.scene=e}),Ri(this,"verticallyCenterObject",()=>{this.textfield.style.marginLeft="auto",this.textfield.style.marginRight="auto",this.textfield.style.right=0,this.textfield.style.left=0}),Ri(this,"getText",()=>this.textfield.value),Ri(this,"setActive",(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.textfield.style.display=e?"block":"none"}));var c=i.sys.game.canvas.parentElement,u=i.sys.game.canvas,{width:d,height:p}=u.getBoundingClientRect(),{width:g,height:y}=i.sys.game.canvas,m=Math.max(d/g,p/y),f=Math.floor(l*m),b=Math.floor(h*m),v=Math.floor(n*m),x=Math.floor(r*m),S=document.createElement("input");if(S.setAttribute("type","text"),S.setAttribute("id",s),S.setAttribute("autocomplete","off"),S.onkeypress=e=>/[A-Za-z0-9_]/i.test(e.key),a&&(this.setPlaceholder(a),S.setAttribute("placeholder",a)),S.style.position="absolute",S.style.top=0,S.style.display="block",h){var w=parseInt(u.style.marginTop,10);S.style.marginTop="".concat(w?b+w:b,"px")}l&&(S.style.marginLeft="".concat(f,"px")),c.appendChild(S),S.focus(),S.style.width="".concat(n?v:S.offsetWidth,"px"),S.style.height="".concat(r?x:S.offsetHeight,"px"),o&&(S.style.fontSize="".concat(o,"px")),this.setWidth(v),this.setHeight(x),this.setY(b),this.setX(f),this.setFontSize(o),this.setTextfield(S),this.setScene(i)}};function Li(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var Wi=class extends Ot{constructor(e){var{scene:t,x:i=0,y:a=0,backgroundColor:n=f,marginColor:r=b,marginSize:o=0,paddingSize:l=0,visible:h=!0,active:c=!0,width:u,centralized:d=!0,onClickCallback:p,spriteKey:g,onPointerOver:y,onPointerOut:m,heroType:v,isSelected:x=!1}=e;super({scene:t,x:i,y:a,visible:h,active:c,spriteKey:g}),Li(this,"setHeroType",e=>{this.heroType=e}),Li(this,"setBackgroundGraphic",e=>{this.backgroundGraphic=e}),Li(this,"setSelectableHeroSprite",e=>{this.selectableHero=e}),Li(this,"setBackgroundSpriteColor",e=>{this.backgroundSpriteColor=e,this.backgroundGraphic.setBackgroundColor(e)}),Li(this,"setMarginSize",e=>{this.marginSize=e}),Li(this,"setIsSelected",e=>{this.isSelected=e}),Li(this,"setOnPointerOver",e=>{this.onPointerOver=e,this.on("pointerover",e)}),Li(this,"setOnPointerOut",e=>{this.onPointerOut=e,this.on("pointerout",e)}),Li(this,"setOnClickCallback",e=>{this.onClickCallback=e;var{height:t,width:i}=this.getCustomBounds(),a=new s.Geom.Rectangle(0,0,i+this.marginSize,t+this.marginSize);this.setInteractive(a,s.Geom.Rectangle.Contains),this.on("pointerup",e)});var S,w=new lt({scene:t,y:l,asset:"hero_09"}).setScale(2),{height:O,width:C}=w.getBounds(),P=O+2*l;S=u?u+2*l:C+2*l,this.setCustomBounds({x:i,y:a,width:S,height:P}),d&&w.setX((S-C)/2),this.setSelectableHeroSprite(w);var k=new Pt({scene:t,x:0,y:0,backgroundColor:n,marginColor:r,marginSize:o,width:S,height:P,spriteKey:g});this.setBackgroundGraphic(k),this.add(k),this.add(w),this.setCustomBounds({x:i,y:a,width:S+o,height:P+o}),p&&this.setOnClickCallback(p),this.setDepth(170),this.setMarginSize(o),this.setIsSelected(x),this.setHeroType(v),y&&m&&(this.setOnPointerOut(m),this.setOnPointerOver(y))}};var qi=class extends z{constructor(){var e,t,i;super("HeroSelectionScene"),i={textInput:{},startGame:{},selectableHero:{},selectedHero:null,menuItemsSprite:[]},(t="state")in(e=this)?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}init(){this.handleSceneStart()}create(){super.create();var e=new gt({scene:this,y:16,text:n.default.t("select_your_hero"),spriteKey:"select_your_hero",uppercase:!0,fontSize:y,originX:0,originY:0});this.add.existing(e),e.verticallyCenterObject();var t=new Wi({scene:this,y:48,asset:"hero_09",heroType:9,spriteKey:"selectable_hero_09",marginSize:3,paddingSize:10});t.setOnClickCallback(()=>{t.isSelected?(this.state.startGame.setAlpha(.5),t.setBackgroundSpriteColor(f),this.setState({selectedHero:null})):(this.state.startGame.setAlpha(1),t.setBackgroundSpriteColor(10923988),this.setState({selectedHero:t.heroType})),t.setIsSelected(!t.isSelected)}),t.verticallyCenterObject(),this.setState({selectableHero:t}),this.add.existing(t);var i=new Vi({scene:this,spriteKey:"text_input",y:170,width:Ei(),height:32,fontSize:30,placeholder:"Nickname"});i.verticallyCenterObject(),this.setState({textInput:i});var s=[],a=new _t({scene:this,y:220,text:n.default.t("start"),spriteKey:"start_game",uppercase:!0,marginSize:2,fontSize:"30px",width:Ei(),alpha:.5,onClickCallback:()=>{if(t.isSelected){i.setActive(!1);var e={heroType:this.state.selectedHero,nickname:i.getText()};this.handleSceneEnd("WaitingRoomScene",e)}}});a.verticallyCenterObject(),a.setOnPointerOver(()=>{a.setSelected(!0)}),a.setOnPointerOut(()=>{a.setSelected(!1)}),a.setOnSelectedOn(()=>{i.getText()&&t.isSelected&&a.setScale(1.02)}),a.setOnSelectedOff(()=>{i.getText()&&t.isSelected&&a.setScale(1)}),s.push(a),this.setState({startGame:a}),this.setState({menuItemsSprite:s}),this.add.existing(a)}};function Ui(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function Ji(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ui(Object(i),!0).forEach((function(t){Qi(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ui(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Qi(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Zi(){var e=Object(he.a)("request-game"),t={heroType:this.data.get("heroType"),nickname:this.data.get("playerNickname")};Object(he.b)(e,t).then($i.bind(this))}function $i(e){var{body:t}=e,{gameId:i}=t;if(i)this.scene.start("MainGameScene",{gameId:i,heroType:this.data.get("heroType"),nickname:this.data.get("playerNickname")});else{var{players:s}=t;s.forEach((e,t)=>{var{nickname:i}=e;if(!Object.prototype.hasOwnProperty.call(this.state.playersNames,i)){var s=new gt({scene:this,text:i,y:100+30*t,x:Ki(),originX:0,originY:0});this.add.existing(s),this.setState(e=>({playersNames:Ji(Ji({},e.playersNames),{},{[i]:s})}))}}),this.time.delayedCall(2e3,Zi.bind(this))}}var es=class extends z{constructor(){var e,t,i;super("WaitingRoomScene"),i={playersNames:{}},(t="state")in(e=this)?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}init(e){this.handleSceneStart();var{nickname:t,heroType:i}=e;this.data.set("playerNickname",t),this.data.set("heroType",i)}create(){super.create();var e=new gt({scene:this,text:n.default.t("waiting_for_players"),y:20,spriteKey:"waiting_for_players",uppercase:!0,fontSize:y,originX:0,originY:0});e.verticallyCenterObject(),this.add.existing(e);var t=new gt({scene:this,text:n.default.t("players_text"),y:70,x:Ki(),spriteKey:"players_text",uppercase:!0,fontSize:y,originX:0,originY:0});this.add.existing(t);var i=new ht({scene:this,y:230});i.verticallyCenterObject(),this.add.existing(i),Zi.call(this)}},ts=i(11),is=i.n(ts),[ss,as]=(()=>{if(p.isMobile){var{innerWidth:e,innerHeight:t}=window,i=t/e;return[384,Math.floor(384*i)]}return[768,576]})(),ns={type:a.a.AUTO,parent:"content",width:ss,height:as,scale:{mode:p.isMobile?a.a.Scale.HEIGHT_CONTROLS_WIDTH:a.a.Scale.FIT,autoCenter:p.isMobile?a.a.Scale.CENTER_HORIZONTALLY:a.a.Scale.CENTER_BOTH},autoRound:!0,pixelArt:!0,localStorageName:"pixel-heroes-showdown",plugins:{global:[{key:"rexAwaitLoader",plugin:is.a,start:!0}]}};function rs(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function os(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?rs(Object(i),!0).forEach((function(t){ls(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):rs(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function ls(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}n.default.use(r.default).init({resources:os({},d)});var hs=os(os({},ns),{},{scene:[H,N,Hi,Xi,Fi,qi,es,Yi]});window.gameSettings={enableGameDebug:!1,mousePosition:{x:0,y:0}};class cs extends s.Game{constructor(){super(hs)}}new cs}]);